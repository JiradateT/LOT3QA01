{% include 'config' %}

in:
  type: {{in_type}}
  driver_path: {{in_driver_path}}
  host: {{in_host}}
  user: {{in_user}}
  password: {{in_password}}
  database: {{in_database}}
  fetch_rows: 30000
  query: |
    SELECT
    DISTINCT
    [rec_person_no] as [rec_person_no],
    [person_no] as [person_no],
    [rec_person_name] as [rec_person_name],
    [company_no] as [company_no],
    [company_prefix] as [company_prefix],
    [company_name] as [company_name],
    [contact_name] as [contact_name],
    [salutation] as [salutation],
    [person_name] as [person_name],
    [nickname] as [nickname],
    [contact_method] as [contact_method],
    [cont_mobile1] as [cont_mobile1],
    [cont_mobile2] as [cont_mobile2],
    [mobile1] as [mobile1],
    [mobile2] as [mobile2],
    [cont_home_phone] as [cont_home_phone],
    [cont_home_ext] as [cont_home_ext],
    [home_phone] as [home_phone],
    [home_ext] as [home_ext],
    [office_phone] as [office_phone],
    [office_ext] as [office_ext],
    [fax] as [fax],
    [cont_fax] as [cont_fax],
    [cont_office_phone] as [cont_office_phone],
    [cont_office_ext] as [cont_office_ext],
    [cont_email] as [cont_email],
    [email] as [email],
    [address] as [address],
    [house_no] as [house_no],
    [village] as [village],
    [building] as [building],
    [soi] as [soi],
    [moo] as [moo],
    [road] as [road],
    [province_th] as [province_th],
    [district_th] as [district_th],
    [sub_district_th] as [sub_district_th],
    [zip_code] as [zip_code],
    [sex] as [sex],
    [birthdate] as [birthdate],
    [occupation1] as [occupation1],
    [occupation2] as [occupation2],
    [occupation3] as [occupation3],
    [occupation_note] as [occupation_note],
    [department] as [department],
    [position] as [position],
    [workplace] as [workplace],
    [hobby] as [hobby],
    [hobby_remark] as [hobby_remark],
    [cont_position] as [cont_position],
    [cont_department] as [cont_department],
    [business1] as [business1],
    [business2] as [business2],
    [business3] as [business3],
    [business_note] as [business_note],
    [segment_group] as [segment_group],
    [segment_th] as [segment_th],
    [contact_time] as [contact_time],
    [transportation_distance] as [transportation_distance],
    [test_drive_date] as [test_drive_date],
    [offer_test_date] as [offer_test_date],
    [sales_opp_create_date] as [sales_opp_create_date],
    [open_date] as [open_date],
    [sales_opp_cancel_date] as [sales_opp_cancel_date],
    [catalog_date] as [catalog_date],
    [nego_date] as [nego_date],
    [type_of_use_date] as [type_of_use_date],
    [offer_finance_date] as [offer_finance_date],
    [book_date] as [book_date],
    [book_sys_date] as [book_sys_date],
    [book_expect_date] as [book_expect_date],
    [book_cancel_date] as [book_cancel_date],
    [rs_date] as [rs_date],
    [rs_cancel_date] as [rs_cancel_date],
    [expect_date] as [expect_date],
    [delivery_date] as [delivery_date],
    [offer_isuzu_care_date] as [offer_isuzu_care_date],
    [offer_mimamori_date] as [offer_mimamori_date],
    [zone_id] as [zone_id],
    [zone_name] as [zone_name],
    [dealer_group_id] as [dealer_group_id],
    [dealer_group_name] as [dealer_group_name],
    [dealer_id] as [dealer_id],
    [dealer_name_th] as [dealer_name_th],
    [branch_id] as [branch_id],
    [branch_name] as [branch_name],
    [dealer_code_book_no] as [dealer_code_book_no],
    [sc_name_th] as [sc_name_th],
    [vin_no] as [vin_no],
    [chassis_no] as [chassis_no],
    [engine_no] as [engine_no],
    [trade_model_th] as [trade_model_th],
    [rear_body_type] as [rear_body_type],
    [rear_body_type_id] as [rear_body_type_id],
    [body_builder_inst_id] as [body_builder_inst_id],
    [body_builder_inst] as [body_builder_inst],
    [book_color_code] as [book_color_code],
    [book_option_desc] as [book_option_desc],
    [follow_up_sales_id] as [follow_up_sales_id],
    [follow_up_status_id] as [follow_up_status_id],
    [sales_opp_no] as [sales_opp_no],
    [sales_opp_status_th] as [sales_opp_status_th],
    [sales_opp_source_th] as [sales_opp_source_th],
    [sales_opp_source_eng] as [sales_opp_source_eng],
    [sales_opp_cancel_reason] as [sales_opp_cancel_reason],
    [sales_opp_cancel_remark] as [sales_opp_cancel_remark],
    [book_no] as [book_no],
    [ios_booking_no] as [ios_booking_no],
    [book_status_th] as [book_status_th],
    [book_cancel_reason] as [book_cancel_reason],
    [book_cancel_remark] as [book_cancel_remark],
    [book_model_code] as [book_model_code],
    [book_model_name] as [book_model_name],
    [book_option_code] as [book_option_code],
    [main_competitor_of_cust] as [main_competitor_of_cust],
    [compare_brannd_th] as [compare_brannd_th],
    [compare_brannd_eng] as [compare_brannd_eng],
    [reg_no] as [reg_no],
    [dn_no] as [dn_no],
    [trade_brand] as [trade_brand],
    [slope] as [slope],
    [priority] as [priority],
    [sales_opp_base_th] as [sales_opp_base_th],
    [use_campaign] as [use_campaign],
    [purchase_type_th] as [purchase_type_th],
    [flat] as [flat],
    [source_activity] as [source_activity],
    [body_builder_company] as [body_builder_company],
    [running_route_to] as [running_route_to],
    [id_no] as [id_no],
    [segment_id] as [segment_id],
    [cv_target_group] as [cv_target_group],
    [sales_opp_source_id] as [sales_opp_source_id],
    [trade_in_year] as [trade_in_year],
    [remark] as [remark],
    [is_ckb] as [is_ckb],
    [trade_model] as [trade_model],
    [body_builder_company_id] as [body_builder_company_id],
    [sc_id] as [sc_id],
    [running_route_from] as [running_route_from],
    [trade_brand_th] as [trade_brand_th],
    [trade_brand_eng] as [trade_brand_eng],
    [interst_market_nm] as [interst_market_nm],
    [key_matching_no_ps] as [key_matching_no_ps],
    [key_matching_no_bk] as [key_matching_no_bk],
    [retails_sales_no] as [retails_sales_no],
    [cvip_date] as [cvip_date],
    [1st_interested_model_group] as [1st_interested_model_group],
    [1st_interested_model_code] as [1st_interested_model_code],
    [1st_interested_sub_model_group1] as [1st_interested_sub_model_group1],
    [1st_interested_sub_model_group2] as [1st_interested_sub_model_group2],
    [1st_interested_option_code] as [1st_interested_option_code],
    [1st_interested_color_code] as [1st_interested_color_code],
    [1st_interested_qty] as [1st_interested_qty],
    [1st_interested_real_demand] as [1st_interested_real_demand],
    [2nd_interested_model_group] as [2nd_interested_model_group],
    [2nd_interested_model_code] as [2nd_interested_model_code],
    [2nd_interested_sub_model_group1] as [2nd_interested_sub_model_group1],
    [2nd_interested_sub_model_group2] as [2nd_interested_sub_model_group2],
    [2nd_interested_option_code] as [2nd_interested_option_code],
    [2nd_interested_color_code] as [2nd_interested_color_code],
    [2nd_interested_qty] as [2nd_interested_qty],
    [2nd_interested_real_demand] as [2nd_interested_real_demand],
    [3rd_interested_model_group] as [3rd_interested_model_group],
    [3rd_interested_model_code] as [3rd_interested_model_code],
    [3rd_interested_sub_model_group1] as [3rd_interested_sub_model_group1],
    [3rd_interested_sub_model_group2] as [3rd_interested_sub_model_group2],
    [3rd_interested_option_code] as [3rd_interested_option_code],
    [3rd_interested_color_code] as [3rd_interested_color_code],
    [3rd_interested_qty] as [3rd_interested_qty],
    [3rd_interested_real_demand] as [3rd_interested_real_demand],
    [1st_nego_model_group] as [1st_nego_model_group],
    [1st_nego_sales_model_name] as [1st_nego_sales_model_name],
    [1st_nego_color] as [1st_nego_color],
    [1st_nego_option] as [1st_nego_option],
    [1st_nego_qty] as [1st_nego_qty],
    [1st_nego_purchase_type] as [1st_nego_purchase_type],
    [1st_nego_installment_type] as [1st_nego_installment_type],
    [1st_nego_finance_company] as [1st_nego_finance_company],
    [1st_nego_down_payment_percent] as [1st_nego_down_payment_percent],
    [1st_nego_down_payment_booking] as [1st_nego_down_payment_booking],
    [1st_nego_down_payment_amount] as [1st_nego_down_payment_amount],
    [1st_nego_interest_rate] as [1st_nego_interest_rate],
    [1st_nego_installment_period_months] as [1st_nego_installment_period_months],
    [1st_nego_installment_period_years] as [1st_nego_installment_period_years],
    [1st_nego_installment_monthly_yearly] as [1st_nego_installment_monthly_yearly],
    [1st_nego_body_builder_inst_id] as [1st_nego_body_builder_inst_id],
    [1st_nego_body_builder_inst] as [1st_nego_body_builder_inst],
    [1st_nego_body_installation_period] as [1st_nego_body_installation_period],
    [1st_nego_body_type] as [1st_nego_body_type],
    [1st_nego_body_type_id] as [1st_nego_body_type_id],
    [1st_nego_body_builder_company] as [1st_nego_body_builder_company],
    [1st_nego_body_builder_company_id] as [1st_nego_body_builder_company_id],
    [2nd_nego_model_group] as [2nd_nego_model_group],
    [2nd_nego_sales_model_name] as [2nd_nego_sales_model_name],
    [2nd_nego_color] as [2nd_nego_color],
    [2nd_nego_option] as [2nd_nego_option],
    [2nd_nego_qty] as [2nd_nego_qty],
    [2nd_nego_purchase_type] as [2nd_nego_purchase_type],
    [2nd_nego_installment_type] as [2nd_nego_installment_type],
    [2nd_nego_finance_company] as [2nd_nego_finance_company],
    [2nd_nego_down_payment_percent] as [2nd_nego_down_payment_percent],
    [2nd_nego_down_payment_booking] as [2nd_nego_down_payment_booking],
    [2nd_nego_down_payment_amount] as [2nd_nego_down_payment_amount],
    [2nd_nego_interest_rate] as [2nd_nego_interest_rate],
    [2nd_nego_installment_period_months] as [2nd_nego_installment_period_months],
    [2nd_nego_installment_period_years] as [2nd_nego_installment_period_years],
    [2nd_nego_installment_monthly_yearly] as [2nd_nego_installment_monthly_yearly],
    [2nd_nego_body_builder_inst_id] as [2nd_nego_body_builder_inst_id],
    [2nd_nego body_builder_inst] as [2nd_nego body_builder_inst],
    [2nd_nego_body_installation_period] as [2nd_nego_body_installation_period],
    [2nd_nego_body_type] as [2nd_nego_body_type],
    [2nd_nego_body_type_id] as [2nd_nego_body_type_id],
    [2nd_nego_body_builder_company] as [2nd_nego_body_builder_company],
    [2nd_nego_body_builder_company_id] as [2nd_nego_body_builder_company_id],
    [3rd_nego_model_group] as [3rd_nego_model_group],
    [3rd_nego_sales_model_name] as [3rd_nego_sales_model_name],
    [3rd_nego_color] as [3rd_nego_color],
    [3rd_nego_option] as [3rd_nego_option],
    [3rd_nego_qty] as [3rd_nego_qty],
    [3rd_nego_purchase_type] as [3rd_nego_purchase_type],
    [3rd_nego_installment_type] as [3rd_nego_installment_type],
    [3rd_nego_finance_company] as [3rd_nego_finance_company],
    [3rd_nego_down_payment_percent] as [3rd_nego_down_payment_percent],
    [3rd_nego_down_payment_booking] as [3rd_nego_down_payment_booking],
    [3rd_nego_down_payment_amount] as [3rd_nego_down_payment_amount],
    [3rd_nego_interest_rate] as [3rd_nego_interest_rate],
    [3rd_nego_installment_period_months] as [3rd_nego_installment_period_months],
    [3rd_nego_installment_period_years] as [3rd_nego_installment_period_years],
    [3rd_nego_installment_monthly_yearly] as [3rd_nego_installment_monthly_yearly],
    [3rd_nego_body_builder_inst_id] as [3rd_nego_body_builder_inst_id],
    [3rd_nego_body_builder_inst] as [3rd_nego_body_builder_inst],
    [3rd_nego_body_installation_period] as [3rd_nego_body_installation_period],
    [3rd_nego_body_type] as [3rd_nego_body_type],
    [3rd_nego_body_type_id] as [3rd_nego_body_type_id],
    [3rd_nego_body_builder_company] as [3rd_nego_body_builder_company],
    [3rd_nego_body_builder_company_id] as [3rd_nego_body_builder_company_id],
    [prospect_id] as [prospect_id],
    [book_id] as [book_id],
    [retail_sales_id] as [retail_sales_id],
    [BranchCode_ProspectCode_BookingNo] as [branchcode_prospectcode_bookingno],
    [ProspectDetailsUpdatedDate] as [prospectdetailsupdateddate],
    [BookingDetailsUpdatedDate] as [bookingdetailsupdateddate],
    [RetailSalesinfoUpdatedDate] as [retailsalesinfoupdateddate]
    FROM [TD].[UDF_Get_SalesAnalysis]

filters:
- type: add_time
  to_column: {name: time, type: timestamp}
  from_value: {mode: upload_time}


out:
  type: td
  apikey: {{out_APIKEY}}
  endpoint: api.treasuredata.com
  database: {{out_database}}
  table: diff_r_prospect_booking_retail_sales
  time_column: time
  mode: replace
  default_timestamp_format: '%Y-%m-%d %H:%M:%S'
  stamp_format: '%Y-%m-%d %H:%M:%S'
  column_options:
    prospectdetailsupdateddate:
      type: string
      value_type: timestamp
      timezone: '+0700'
    bookingdetailsupdateddate:
      type: string
      value_type: timestamp
      timezone: '+0700'
    retailsalesinfoupdateddate:
      type: string
      value_type: timestamp
      timezone: '+0700'
