{% include 'config' %}

in:
  type: {{in_type}}
  driver_path: {{in_driver_path}}
  host: {{in_host}}
  user: {{in_user}}
  password: {{in_password}}
  database: {{in_database}}
  fetch_rows: 3000
  query: |
    SELECT
        DealerGroupId as dealer_group_id,
        DealerGroupCode as dealer_group_code,
        DealerGroupName as dealer_group_name,
        IsTISGroup as is_tis_group,
        DealerCompanyId as dealer_company_id,
        CompanyCode as company_code,
        CompanyName as company_name,
        DealerRegionId as dealer_region_id,
        DealerRegion as dealer_region,
        DealerId as dealer_id,
        DealerCode as dealer_code,
        DealerName as dealer_name,
        DealerType as dealer_type,
        TaxRegistrationNumber as tax_registration_number,
        DealerRolloutDate as dealer_rollout_date,
        Dealer_HouseNo as dealer_house_no,
        Dealer_Floor as dealer_floor,
        Dealer_RoomNo as dealer_room_no,
        Dealer_Building as dealer_building,
        Dealer_Village as dealer_village,
        Dealer_Soi as dealer_soi,
        Dealer_Moo as dealer_moo,
        Dealer_Road as dealer_road,
        Dealer_Province as dealer_province,
        Dealer_District as dealer_district,
        Dealer_SubDistrict as dealer_sub_district,
        Dealer_ZipCode as dealer_zip_code,
        BranchId as branch_id,
        BranchCode as branch_code,
        BranchName as branch_name,
        BranchShortName as branch_short_name,
        Branch_HouseNo as branch_house_no,
        Branch_Floor as branch_floor,
        Branch_RoomNo as branch_room_no,
        Branch_Building as branch_building,
        Branch_Village as branch_village,
        Branch_Soi as branch_soi,
        Branch_Moo as branch_moo,
        Branch_Road as branch_road,
        Branch_Province as branch_province,
        Branch_District as branch_district,
        Branch_SubDistrict as branch_sub_district,
        Branch_ZipCode as branch_zip_code,
        IsHQ as is_hq,
        IsDroppingLocation as is_dropping_location,
        BranchTaxID as branch_tax_id,
        IsVehicleOrderHQ as is_vehicle_order_hq,
        SalesOperations as sales_operations,
        ServiceOperations as service_operations,
        PartOrdertoOEM as part_order_to_oem,
        PartsOperations as parts_operations,
        ServiceCentreCode as service_centre_code,
        ServiceCentrePhoneNoFrom as service_centre_phone_no_from,
        ServiceCentrePhoneNoTo as service_centre_phone_no_to,
        ServiceCentrePhoneNoExt as service_centre_phone_no_ext,
        ServiceCentreFaxNoFrom as service_centre_fax_no_from,
        ServiceCentreFaxNoTo as service_centre_fax_no_to,
        AppointmentPhoneNoFrom as appointment_phone_no_from,
        AppointmentPhoneNoTo as appointment_phone_no_to,
        AppointmentPhoneNoExt as appointment_phone_no_ext,
        SalesOfficePhoneNoFrom as sales_office_phone_no_from,
        SalesOfficePhoneNoTo as sales_office_phone_no_to,
        SalesOfficePhoneNoExt as sales_office_phone_no_ext,
        SalesOfficeFaxNoFrom as sales_office_fax_no_from,
        SalesOfficeFaxNoTo as sales_office_fax_no_to,
        TypeofServiceCentre as type_of_service_centre,
        OpenforService as open_for_service,
        VehicleInspectionService as vehicle_inspection_service,
        BodyPaintShop as body_paint_shop,
        CVMobileService as cv_mobile_service,
        LCVMobileService as lcv_mobile_service,
        AuthorizedCNG as authorized_cng,
        CVIOSPassed as cv_ios_passed,
        LCVIOSPassed as lcv_ioc_passed,
        iTruckSolution as i_truck_solution,
        GreenGarage as green_garage,
        WorkingTime_Mon_Fri as working_time_mon_fri,
        WorkingTime_Sat as working_time_sat,
        WorkingTime_Sun as working_time_sun,
        PartCreditAvailability as part_credit_availability,
        BranchContact_HouseNo as branch_contact_house_no,
        BranchContact_Floor as branch_contact_floor,
        BranchContact_RoomNo as branch_contact_room_no,
        BranchContact_Building as branch_contact_building,
        BranchContact_Village as branch_contact_village,
        BranchContact_Soi as branch_contact_soi,
        BranchContact_Moo as branch_contact_moo,
        BranchContact_Road as branch_contact_road,
        BranchContact_Province as branch_contact_province,
        BranchContact_District as branch_contact_district,
        BranchContact_SubDistrict as branch_contact_sub_district,
        BranchContact_ZipCode as branch_contact_zip_code,
        IsActive as is_active,
        UpdatedByUser as updated_by_user,
        UpdatedDate as updated_date
        FROM TD.VW_CM_DealerNetwork

filters:
- type: add_time
  to_column: {name: time, type: timestamp}
  from_value: {mode: upload_time}
out: {type: td, apikey: {{out_APIKEY}}, endpoint: api.treasuredata.com,
  database: {{out_database}}, table: r_dealer_network, time_column: time, mode: replace, default_timestamp_format: '%Y-%m-%d
    %H:%M:%S', stamp_format: '%Y-%m-%d %H:%M:%S'}